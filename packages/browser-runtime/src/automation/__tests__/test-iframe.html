<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Iframe AX Tree Test Page</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    iframe {
      width: 100%;
      height: 400px;
      border: 2px solid #333;
      margin: 20px 0;
    }
    .test-section {
      margin: 20px 0;
      padding: 15px;
      background: #f5f5f5;
      border-radius: 5px;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    #output {
      margin-top: 20px;
      padding: 15px;
      background: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      white-space: pre-wrap;
      font-family: monospace;
      max-height: 500px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Iframe AX Tree Test Page</h1>
    
    <div class="test-section">
      <h2>Main Page Content</h2>
      <p>This is the main page content. Below are iframes with different content.</p>
      <button id="main-button">Main Page Button</button>
      <input type="text" placeholder="Main page input" id="main-input">
    </div>

    <div class="test-section">
      <h2>Iframe 1: Simple Content</h2>
      <iframe id="iframe1" src="data:text/html;charset=utf-8,
        <!DOCTYPE html>
        <html>
        <head><title>Iframe 1</title></head>
        <body>
          <h1>Iframe 1 Content</h1>
          <p>This is content inside iframe 1.</p>
          <button>Iframe 1 Button</button>
          <input type='text' placeholder='Iframe 1 input'>
          <a href='#'>Iframe 1 Link</a>
        </body>
        </html>
      "></iframe>
    </div>

    <div class="test-section">
      <h2>Iframe 2: Nested Iframe</h2>
      <iframe id="iframe2" src="data:text/html;charset=utf-8,
        <!DOCTYPE html>
        <html>
        <head><title>Iframe 2</title></head>
        <body>
          <h1>Iframe 2 Content</h1>
          <p>This iframe contains another nested iframe.</p>
          <button>Iframe 2 Button</button>
          <iframe src='data:text/html;charset=utf-8,
            <!DOCTYPE html>
            <html>
            <head><title>Nested Iframe</title></head>
            <body>
              <h2>Nested Iframe Content</h2>
              <button>Nested Button</button>
              <input type='text' placeholder='Nested input'>
            </body>
            </html>
          ' style='width:100%;height:200px;border:1px solid #ccc;'></iframe>
        </body>
        </html>
      "></iframe>
    </div>

    <div class="test-section">
      <h2>Iframe 3: Complex Content</h2>
      <iframe id="iframe3" src="data:text/html;charset=utf-8,
        <!DOCTYPE html>
        <html>
        <head><title>Iframe 3</title></head>
        <body>
          <h1>Complex Iframe Content</h1>
          <form>
            <label>Name: <input type='text' name='name'></label>
            <label>Email: <input type='email' name='email'></label>
            <button type='submit'>Submit</button>
          </form>
          <div>
            <h2>Interactive Elements</h2>
            <button>Button 1</button>
            <button>Button 2</button>
            <a href='#'>Link 1</a>
            <a href='#'>Link 2</a>
            <input type='checkbox' id='check1'><label for='check1'>Checkbox 1</label>
            <input type='radio' name='radio' id='radio1'><label for='radio1'>Radio 1</label>
          </div>
        </body>
        </html>
      "></iframe>
    </div>

    <div class="test-section">
      <h2>Test Controls</h2>
      <button onclick="testSnapshot(true)">Test Snapshot (with iframes)</button>
      <button onclick="testSnapshot(false)">Test Snapshot (without iframes)</button>
      <button onclick="clearOutput()">Clear Output</button>
    </div>

    <div id="output"></div>
  </div>

  <script>
    // This script will be injected into the page to test snapshot functionality
    // In a real scenario, this would be called from the extension's content script
    
    function log(message) {
      const output = document.getElementById('output');
      if (output) {
        output.textContent += `${message}\n`;
        output.scrollTop = output.scrollHeight;
      }
      console.log(message);
    }

    function _clearOutput() {
      const output = document.getElementById('output');
      if (output) {
        output.textContent = '';
      }
    }

    async function _testSnapshot(includeIframes) {
      log(`\n=== Testing Snapshot (includeIframes: ${includeIframes}) ===`);
      log(`Time: ${new Date().toISOString()}`);
      
      try {
        // In a real extension, you would call:
        // const result = await chrome.runtime.sendMessage({
        //   action: 'takeSnapshot',
        //   includeIframes: includeIframes
        // });
        
        log('Note: This is a test page. In a real scenario, you would:');
        log('1. Load this page in Chrome');
        log('2. Open the extension');
        log('3. Call takeSnapshot tool with includeIframes parameter');
        log('4. Check the snapshot output for iframe content');
        
        log('\nExpected behavior:');
        if (includeIframes) {
          log('- Snapshot should include content from all 3 iframes');
          log('- Snapshot should include nested iframe content (iframe 2)');
          log('- All buttons, inputs, and links from iframes should be visible');
        } else {
          log('- Snapshot should NOT include iframe content');
          log('- Only main page elements should be visible');
        }
        
      } catch (error) {
        log(`Error: ${error.message}`);
        console.error(error);
      }
    }

    // Log page load
    log('Iframe Test Page Loaded');
    log('This page contains:');
    log('- 1 main page with button and input');
    log('- 3 iframes with various content');
    log('- 1 nested iframe (inside iframe 2)');
  </script>
</body>
</html>
